Bahan_Dinding == 4 ~ "Anyaman bambu",
Bahan_Dinding == 5 ~ "Batang kayu",
Bahan_Dinding == 6 ~ "Bambu",
Bahan_Dinding == 7 ~ "Lainnya",
TRUE ~ NA_character_
),
Bahan_Atap = case_when(
Bahan_Atap == 1 ~ "Beton",
Bahan_Atap == 2 ~ "Genteng",
Bahan_Atap == 3 ~ "Seng",
Bahan_Atap == 4 ~ "Asbes",
Bahan_Atap == 5 ~ "Bambu",
Bahan_Atap == 6 ~ "Kayu/sirap",
Bahan_Atap == 7 ~ "Jerami/ijuk/daun-daunan/rumbia",
Bahan_Atap == 8 ~ "Lainnya",
TRUE ~ NA_character_
)
)
View(data_kur)
data_kur <- data_kur %>%
rename(
Penerima_KUR = R1901A,
) %>%
mutate(
Klasifikasi_Perkotaan_Perdesaan = case_when(
Klasifikasi_Perkotaan_Perdesaan == 1 ~ "Perkotaan",
Klasifikasi_Perkotaan_Perdesaan == 2 ~ "Perdesaan",
TRUE ~ NA_character_
),
Status_Kepemilikan_Rumah = case_when(
Status_Kepemilikan_Rumah == 1 ~ "Milik Sendiri",
Status_Kepemilikan_Rumah == 2 ~ "Kontrak",
Status_Kepemilikan_Rumah == 3 ~ "Bebas Sewa",
Status_Kepemilikan_Rumah == 4 ~ "Dinas",
Status_Kepemilikan_Rumah == 5 ~ "Lainnya",
TRUE ~ NA_character_
),
Memiliki_Rumah_Lain = case_when(
Memiliki_Rumah_Lain == 1 ~ "Ya",
Memiliki_Rumah_Lain == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Penerima_KUR = case_when(
Penerima_KUR == 1 ~ "Ya",
Penerima_KUR == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Menerima_Kredit_Lain = case_when(
Menerima_Kredit_Lain == 1 ~ "Ya",
Menerima_Kredit_Lain == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Gas_Min5kg = case_when(
Memiliki_Gas_Min5kg == 1 ~ "Ya",
Memiliki_Gas_Min5kg == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Kulkas = case_when(
Memiliki_Kulkas == 1 ~ "Ya",
Memiliki_Kulkas == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_AC = case_when(
Memiliki_AC == 1 ~ "Ya",
Memiliki_AC == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Motor = case_when(
Memiliki_Motor == 1 ~ "Ya",
Memiliki_Motor == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Mobil = case_when(
Memiliki_Mobil == 1 ~ "Ya",
Memiliki_Mobil == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Lahan = case_when(
Memiliki_Lahan == 1 ~ "Ya",
Memiliki_Lahan == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Sumber_Pembiayaan = case_when(
Sumber_Pembiayaan == 1 ~ "ART Bekerja",
Sumber_Pembiayaan == 2 ~ "Kiriman",
Sumber_Pembiayaan == 3 ~ "Investasi",
Sumber_Pembiayaan == 4 ~ "Pensiunan",
TRUE ~ NA_character_
),
Memiliki_Fasilitas_BAB = case_when(
Memiliki_Fasilitas_BAB == 1 ~ "Ada digunakan ART sendiri",
Memiliki_Fasilitas_BAB == 2 ~ "Ada bersama RT lain",
Memiliki_Fasilitas_BAB == 3 ~ "Ada MCK komunal",
Memiliki_Fasilitas_BAB == 4 ~ "Ada MCK Umum",
Memiliki_Fasilitas_BAB == 5 ~ "Ada ART tidak menggunakan",
Memiliki_Fasilitas_BAB == 6 ~ "Tidak ada",
TRUE ~ NA_character_
),
Bahan_Lantai = case_when(
Bahan_Lantai == 1 ~ "Marmer/granit",
Bahan_Lantai == 2 ~ "Keramik",
Bahan_Lantai == 3 ~ "Parket/vinil/karpet",
Bahan_Lantai == 4 ~ "Ubin/tegel/teraso",
Bahan_Lantai == 5 ~ "Kayu/papan",
Bahan_Lantai == 6 ~ "Semen/bata",
Bahan_Lantai == 7 ~ "Bambu",
Bahan_Lantai == 8 ~ "Tanah",
Bahan_Lantai == 9 ~ "Lainnya",
TRUE ~ NA_character_
),
Bahan_Dinding = case_when(
Bahan_Dinding == 1 ~ "Tembok",
Bahan_Dinding == 2 ~ "Plesteran anyaman bambu/kawat",
Bahan_Dinding == 3 ~ "Kayu/papan",
Bahan_Dinding == 4 ~ "Anyaman bambu",
Bahan_Dinding == 5 ~ "Batang kayu",
Bahan_Dinding == 6 ~ "Bambu",
Bahan_Dinding == 7 ~ "Lainnya",
TRUE ~ NA_character_
),
Bahan_Atap = case_when(
Bahan_Atap == 1 ~ "Beton",
Bahan_Atap == 2 ~ "Genteng",
Bahan_Atap == 3 ~ "Seng",
Bahan_Atap == 4 ~ "Asbes",
Bahan_Atap == 5 ~ "Bambu",
Bahan_Atap == 6 ~ "Kayu/sirap",
Bahan_Atap == 7 ~ "Jerami/ijuk/daun-daunan/rumbia",
Bahan_Atap == 8 ~ "Lainnya",
TRUE ~ NA_character_
)
)
data_kur <- data_kur %>%
rename(
Penerima_KUR = R1901A,
) %>%
mutate(
Klasifikasi_Daerah = case_when(
Klasifikasi_Daerah == 1 ~ "Perkotaan",
Klasifikasi_Daerah == 2 ~ "Perdesaan",
TRUE ~ NA_character_
),
Status_Kepemilikan_Rumah = case_when(
Status_Kepemilikan_Rumah == 1 ~ "Milik Sendiri",
Status_Kepemilikan_Rumah == 2 ~ "Kontrak",
Status_Kepemilikan_Rumah == 3 ~ "Bebas Sewa",
Status_Kepemilikan_Rumah == 4 ~ "Dinas",
Status_Kepemilikan_Rumah == 5 ~ "Lainnya",
TRUE ~ NA_character_
),
Memiliki_Rumah_Lain = case_when(
Memiliki_Rumah_Lain == 1 ~ "Ya",
Memiliki_Rumah_Lain == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Penerima_KUR = case_when(
Penerima_KUR == 1 ~ "Ya",
Penerima_KUR == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Menerima_Kredit_Lain = case_when(
Menerima_Kredit_Lain == 1 ~ "Ya",
Menerima_Kredit_Lain == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Gas_Min5kg = case_when(
Memiliki_Gas_Min5kg == 1 ~ "Ya",
Memiliki_Gas_Min5kg == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Kulkas = case_when(
Memiliki_Kulkas == 1 ~ "Ya",
Memiliki_Kulkas == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_AC = case_when(
Memiliki_AC == 1 ~ "Ya",
Memiliki_AC == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Motor = case_when(
Memiliki_Motor == 1 ~ "Ya",
Memiliki_Motor == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Mobil = case_when(
Memiliki_Mobil == 1 ~ "Ya",
Memiliki_Mobil == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Memiliki_Lahan = case_when(
Memiliki_Lahan == 1 ~ "Ya",
Memiliki_Lahan == 5 ~ "Tidak",
TRUE ~ NA_character_
),
Sumber_Pembiayaan = case_when(
Sumber_Pembiayaan == 1 ~ "ART Bekerja",
Sumber_Pembiayaan == 2 ~ "Kiriman",
Sumber_Pembiayaan == 3 ~ "Investasi",
Sumber_Pembiayaan == 4 ~ "Pensiunan",
TRUE ~ NA_character_
),
Memiliki_Fasilitas_BAB = case_when(
Memiliki_Fasilitas_BAB == 1 ~ "Ada digunakan ART sendiri",
Memiliki_Fasilitas_BAB == 2 ~ "Ada bersama RT lain",
Memiliki_Fasilitas_BAB == 3 ~ "Ada MCK komunal",
Memiliki_Fasilitas_BAB == 4 ~ "Ada MCK Umum",
Memiliki_Fasilitas_BAB == 5 ~ "Ada ART tidak menggunakan",
Memiliki_Fasilitas_BAB == 6 ~ "Tidak ada",
TRUE ~ NA_character_
),
Bahan_Lantai = case_when(
Bahan_Lantai == 1 ~ "Marmer/granit",
Bahan_Lantai == 2 ~ "Keramik",
Bahan_Lantai == 3 ~ "Parket/vinil/karpet",
Bahan_Lantai == 4 ~ "Ubin/tegel/teraso",
Bahan_Lantai == 5 ~ "Kayu/papan",
Bahan_Lantai == 6 ~ "Semen/bata",
Bahan_Lantai == 7 ~ "Bambu",
Bahan_Lantai == 8 ~ "Tanah",
Bahan_Lantai == 9 ~ "Lainnya",
TRUE ~ NA_character_
),
Bahan_Dinding = case_when(
Bahan_Dinding == 1 ~ "Tembok",
Bahan_Dinding == 2 ~ "Plesteran anyaman bambu/kawat",
Bahan_Dinding == 3 ~ "Kayu/papan",
Bahan_Dinding == 4 ~ "Anyaman bambu",
Bahan_Dinding == 5 ~ "Batang kayu",
Bahan_Dinding == 6 ~ "Bambu",
Bahan_Dinding == 7 ~ "Lainnya",
TRUE ~ NA_character_
),
Bahan_Atap = case_when(
Bahan_Atap == 1 ~ "Beton",
Bahan_Atap == 2 ~ "Genteng",
Bahan_Atap == 3 ~ "Seng",
Bahan_Atap == 4 ~ "Asbes",
Bahan_Atap == 5 ~ "Bambu",
Bahan_Atap == 6 ~ "Kayu/sirap",
Bahan_Atap == 7 ~ "Jerami/ijuk/daun-daunan/rumbia",
Bahan_Atap == 8 ~ "Lainnya",
TRUE ~ NA_character_
)
)
data_kur <- read.csv("data_fix_baru.csv")
head(data_kur)
data_kur <- read.csv("data_fix_new.csv")
head(data_kur)
View(data_kur)
data_summary_class <- data_kur %>%
group_by(R1901A) %>%
summarise(count = n()) %>%
mutate(percentage = count / sum(count) * 100)
data_summary_class <- data_kur %>%
group_by(Penerima_KUR) %>%
summarise(count = n()) %>%
mutate(percentage = count / sum(count) * 100)
ggplot(data_summary_class, aes(x = "", y = count, fill = as.factor(Penerima_KUR))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(count, " (", round(percentage, 1), "%)")),
position = position_stack(vjust = 0.5),
color = "black") +
labs(title = "Distribusi Penerima KUR Di 5 Kabupaten/Kota Provinsi Jawa Barat",
fill = "Status Penerima KUR") +
scale_fill_manual(values = c("1" = "green", "5" = "red"),
labels = c("Ya", "Tidak")) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank()
)
knitr::opts_chunk$set(echo = TRUE)
library(class)
library(caret)
library(themis)
library(e1071)
library(dplyr)
library(psych)
library(ggplot2)
library(ggpubr)
library(pROC)
library(DataExplorer)
library(pscl)
library(lares)
library(tidyverse)
library(tidymodels)
library(themis)
library(tidyposterior)
library(SmartEDA)
library(DataExplorer)
library(skimr)
library(ggpubr)
library(workflowsets)
data_kur <- read.csv("data_fix_new.csv")
head(data_kur)
data_summary_class <- data_kur %>%
group_by(Penerima_KUR) %>%
summarise(count = n()) %>%
mutate(percentage = count / sum(count) * 100)
ggplot(data_summary_class, aes(x = "", y = count, fill = as.factor(Penerima_KUR))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(count, " (", round(percentage, 1), "%)")),
position = position_stack(vjust = 0.5),
color = "black") +
labs(title = "Distribusi Penerima KUR Di 5 Kabupaten/Kota Provinsi Jawa Barat",
fill = "Status Penerima KUR") +
scale_fill_manual(values = c("1" = "green", "5" = "red"),
labels = c("Ya", "Tidak")) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank()
)
# Mengonversi Kode_Kabupaten menjadi faktor
data_kur$Kode_Kabupaten <- as.factor(data_kur$Kode_Kabupaten)
# Memeriksa levelnya
levels(data_kur$Kode_Kabupaten)
data_processed <- data_kur %>%
select(
Penerima_KUR,
Kode_Kabupaten,
Klasifikasi_Perkotaan_Perdesaan,
Status_Kepemilikan_Rumah,
Memiliki_Rumah_Lain,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Menerima_Kredit_Lain,
Memiliki_Gas_Min5kg,
Memiliki_Kulkas,
Memiliki_AC,
Memiliki_Motor,
Memiliki_Mobil,
Memiliki_Lahan,
Pengeluaran_Per_Kapita,
Luas_Lantai_Bangunan,
Jumlah_ART
) %>%
mutate(
across(
c(
Penerima_KUR,
Kode_Kabupaten,
Klasifikasi_Perkotaan_Perdesaan,
Status_Kepemilikan_Rumah,
Memiliki_Rumah_Lain,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Menerima_Kredit_Lain,
Memiliki_Gas_Min5kg,
Memiliki_Kulkas,
Memiliki_AC,
Memiliki_Motor,
Memiliki_Mobil,
Memiliki_Lahan
),
as.factor
),
Pengeluaran_Per_Kapita = as.numeric(Pengeluaran_Per_Kapita),
Luas_Lantai_Bangunan = as.numeric(Luas_Lantai_Bangunan),
Jumlah_ART = as.numeric(Jumlah_ART)
)
head(data_processed)
plot_intro(data_processed,ggtheme = theme_pubr())
library(ggplot2)
library(reshape2)
# Pilih hanya kolom numerik dari data_olah
numerical_data <- data_processed %>% select(where(is.numeric))
# Hitung korelasi antar variabel numerik
cor_matrix <- cor(numerical_data, use = "complete.obs")
# Visualisasi matriks korelasi menggunakan heatmap
cor_matrix_melt <- melt(cor_matrix)  # Ubah format ke long untuk ggplot
ggplot(cor_matrix_melt, aes(Var1, Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), color = "black", size = 3) +  # Tambahkan angka di dalam kotak
scale_fill_gradient2(low = "blue", high = "red", mid = "white", midpoint = 0,
limit = c(-1, 1), space = "Lab", name = "Correlation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
coord_fixed() +
ggtitle("Heatmap Korelasi Antar Variabel Numerik")
summary(data_processed$Pengeluaran_Per_Kapita)
summary(data_processed$Jumlah_ART)
summary(data_processed$Luas_Lantai_Bangunan)
set.seed(1014)
rec_ohe <- recipe(Penerima_KUR ~ ., data = data_processed) %>%
step_dummy(
Status_Kepemilikan_Rumah,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Sumber_Pembiayaan
)
data_processed <- prep(rec_ohe) %>% juice()
View(data_processed)
data_processed <- data_kur %>%
select(
Penerima_KUR,
Kode_Kabupaten,
Klasifikasi_Perkotaan_Perdesaan,
Status_Kepemilikan_Rumah,
Memiliki_Rumah_Lain,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Menerima_Kredit_Lain,
Memiliki_Gas_Min5kg,
Memiliki_Kulkas,
Memiliki_AC,
Memiliki_Motor,
Memiliki_Mobil,
Memiliki_Lahan,
Pengeluaran_Per_Kapita,
Sumber_Pembiayaan
Luas_Lantai_Bangunan,
data_processed <- data_kur %>%
select(
Penerima_KUR,
Kode_Kabupaten,
Klasifikasi_Perkotaan_Perdesaan,
Status_Kepemilikan_Rumah,
Memiliki_Rumah_Lain,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Menerima_Kredit_Lain,
Memiliki_Gas_Min5kg,
Memiliki_Kulkas,
Memiliki_AC,
Memiliki_Motor,
Memiliki_Mobil,
Memiliki_Lahan,
Pengeluaran_Per_Kapita,
Sumber_Pembiayaan,
Luas_Lantai_Bangunan,
Jumlah_ART
) %>%
mutate(
across(
c(
Penerima_KUR,
Kode_Kabupaten,
Klasifikasi_Perkotaan_Perdesaan,
Status_Kepemilikan_Rumah,
Memiliki_Rumah_Lain,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Menerima_Kredit_Lain,
Memiliki_Gas_Min5kg,
Memiliki_Kulkas,
Memiliki_AC,
Memiliki_Motor,
Sumber_Pembiayaan,
Memiliki_Mobil,
Memiliki_Lahan
),
as.factor
),
Pengeluaran_Per_Kapita = as.numeric(Pengeluaran_Per_Kapita),
Luas_Lantai_Bangunan = as.numeric(Luas_Lantai_Bangunan),
Jumlah_ART = as.numeric(Jumlah_ART)
)
head(data_processed)
set.seed(1014)
rec_ohe <- recipe(Penerima_KUR ~ ., data = data_processed) %>%
step_dummy(
Status_Kepemilikan_Rumah,
Bahan_Atap,
Bahan_Dinding,
Bahan_Lantai,
Memiliki_Fasilitas_BAB,
Sumber_Pembiayaan
)
data_processed <- prep(rec_ohe) %>% juice()
set.seed(1088)
split_index <- createDataPartition(data_processed$Penerima_KUR, p = 0.7, list = FALSE)
data_train <- data_processed[split_index, ]
data_test <- data_processed[-split_index, ]
f_data_asli <- as.vector(table(data_processed$Penerima_KUR))
f_data_latih <- as.vector(table(data_train$Penerima_KUR))
f_data_uji <- as.vector(table(data_test$Penerima_KUR))
nama_data <- c("Data Asli", "Data Latih", "Data Uji")
partisi_data <- data.frame(nama_data, rbind(f_data_asli, f_data_latih, f_data_uji))
rownames(partisi_data) <- NULL
colnames(partisi_data) <- c("Data", "Tidak", "Ya")
partisi_data
data_train %>%
ggplot(aes(x = Penerima_KUR)) +
geom_bar(fill = "red") +
ggtitle("Distribusi Penerima KUR di Data Latih") +
theme(legend.position = "none")
write.csv(data_train, "data_train.csv", row.names=FALSE)
write.csv(data_test, "data_test.csv", row.names=FALSE)
View(data_processed)
write.csv(data_processed, "data_processed", row.names=FALSE)
head(data_processed)
View(data_processed)
